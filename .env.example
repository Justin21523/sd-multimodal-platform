# .env.example
# Storage/layout MUST follow: ~/Desktop/data_model_structure.md
# - caches:  /mnt/c/ai_cache
# - models:  /mnt/c/ai_models
# - outputs: /mnt/data/...
AI_CACHE_ROOT=/mnt/c/ai_cache
AI_MODELS_ROOT=/mnt/c/ai_models
AI_OUTPUT_ROOT=/mnt/data/training/runs/sd-multimodal-platform

HF_HOME=/mnt/c/ai_cache/huggingface
TRANSFORMERS_CACHE=/mnt/c/ai_cache/huggingface
HF_DATASETS_CACHE=/mnt/c/ai_cache/huggingface/datasets
HUGGINGFACE_HUB_CACHE=/mnt/c/ai_cache/huggingface/hub
TORCH_HOME=/mnt/c/ai_cache/torch
XDG_CACHE_HOME=/mnt/c/ai_cache

# === Basic API Settings ===
API_PREFIX=/api/v1
APP_NAME="SD Multimodal Platform"
APP_VERSION="0.1.0"
PORT=8000
HOST=0.0.0.0
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080,http://localhost:5173,http://localhost:4173,http://localhost:8000

# === Environment and Mode Settings ===
ENVIRONMENT=development
MINIMAL_MODE=false
DEBUG=true

# === Model Configuration ===
SD_MODEL=runwayml/stable-diffusion-v1-5
CONTROLNET_MODEL=lllyasviel/sd-controlnet-canny
CAPTION_MODEL=Salesforce/blip2-opt-2.7b
VQA_MODEL=llava-hf/llava-1.5-7b-hf
PRIMARY_MODEL=sdxl-base
CHAT_MODEL=Qwen/Qwen2-7B-Instruct
EMBEDDING_MODEL=BAAI/bge-m3

# Device and Precision
DEVICE=auto
PRECISION=float16
ENABLE_4BIT=false
ENABLE_8BIT=false

# Memory Optimizations
ENABLE_ATTENTION_SLICING=true
ENABLE_XFORMERS=true
ENABLE_VAE_SLICING=true
ENABLE_CPU_OFFLOAD=false

# Rate Limiting
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_MINUTES=1
MAX_CONCURRENT_TASKS=4

# Output Settings
# NOTE: OUTPUT_PATH/ASSETS_PATH/LOG_FILE_PATH are derived from AI_OUTPUT_ROOT in `app/config.py`
# OUTPUT_PATH={AI_OUTPUT_ROOT}/outputs
# ASSETS_PATH={AI_OUTPUT_ROOT}/assets
# LOG_FILE_PATH={AI_OUTPUT_ROOT}/logs/app.log
OUTPUT_FORMAT=webp
OUTPUT_QUALITY=95

# Offline Mode
OFFLINE_MODE=false

# === Hardware Configuration ===
DEVICE=cuda
TORCH_DTYPE=float16
USE_SDPA=true
ENABLE_XFORMERS=false
ENABLE_CPU_OFFLOAD=false
USE_ATTENTION_SLICING=true


# === Generation Settings ===
DEFAULT_WIDTH=1024
DEFAULT_HEIGHT=1024
DEFAULT_STEPS=25
DEFAULT_CFG=7.5
DEFAULT_SAMPLER=DPM++ 2M Karras

# === Performance Limits ===
MAX_WORKERS=1
MAX_BATCH_SIZE=4
REQUEST_TIMEOUT=300
MAX_FILE_SIZE=10

# === Phase 5: Queue Configuration ===
ENABLE_QUEUE=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# === Celery Configuration ===
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# === Task Queue Settings ===
TASK_TIME_LIMIT=3600
TASK_SOFT_TIME_LIMIT=3300
WORKER_MAX_TASKS=10
TASK_RETENTION_HOURS=72

# === Post-processing Settings ===
ENABLE_POSTPROCESS=true
POSTPROCESS_MAX_IMAGES=10
UPSCALE_MAX_SCALE=4

# === Batch Processing Settings ===
BATCH_TIMEOUT=7200

# === Memory Management ===
VRAM_CLEANUP_THRESHOLD=0.8
AUTO_CLEANUP_MODELS=true

# === Security Settings ===
SECRET_KEY=your-super-secret-key-change-this-in-production
ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_EXPIRE_HOURS=24
ENABLE_NSFW_FILTER=true
ENABLE_RATE_LIMITING=true

# Security & Rate Limiting
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW_SEC=60
RATE_LIMIT_BURST=10

# Generation Limits
MAX_STEPS=100
MAX_CFG=20.0
MAX_PIXELS=1048576
MAX_UPLOAD_MB=50
MAX_VIDEO_DURATION=300
MAX_CONCURRENT_TASKS=4
MAX_RETRIES=3
RETRY_BACKOFF_SEC=5

# Security
API_KEYS=["test-key-1","test-key-2"]
JWT_PUBLIC_KEYS_URL=
ALLOWED_IMAGE_TYPES=["image/jpeg","image/png","image/webp"]

# Observability
ENABLE_PROMETHEUS=false
ENABLE_REQUEST_ID=true
LOG_BODY_LIMIT_BYTES=4096

# === Logging and Monitoring ===
LOG_LEVEL=INFO
ENABLE_REQUEST_LOGGING=true
ENABLE_PROMETHEUS=false
SENTRY_DSN=

# === Storage Settings ===
ENABLE_METADATA_LOGGING=true
KEEP_GENERATIONS_DAYS=7
