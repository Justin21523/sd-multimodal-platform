# env-text2img.yml - Conda base environment (no PyTorch inside)
# Goal:
#   1) Keep your original package set and versions as-is.
#   2) Do NOT install torch/torchvision/torchaudio here.
#   3) Add only minimal missing essentials (e.g., python-dotenv).
#   4) Install the PyTorch trio later via requirements.txt (Nightly cu124).

name: sd-multimodal-platform
channels:
  - conda-forge # Community-maintained packages
  - defaults # Anaconda default channel

dependencies:
  # core Python Runtime
  - python=3.10
  - pip
  - setuptools
  - wheel
  - pip:
      # Diffusion Models Core
      - diffusers>=0.29.0 # HuggingFace diffusion pipeline
      - transformers>=4.43.0 # Language model transformers
      - accelerate>=0.31.0 # Multi-GPU training acceleration
      - xformers==0.0.27.post2 # Memory-efficient attention (was paired with torch 2.3 + cu121)
      - controlnet-aux>=0.6.0 # ControlNet auxiliary functions
      - safetensors>=0.4.3 # Efficient tensor storage format
      - einops>=0.7.0 # Flexible tensor operations
      - huggingface_hub>=0.24.0 # HuggingFace model hub integration

      # API & Web
      - fastapi>=0.111.0 # High-performance async API
      - uvicorn[standard]>=0.30.0 # ASGI server with WebSocket support
      - gradio>=4.36.0 # Web UI for model interaction
      - pydantic>=2.8.0 # Data validation and settings management
      - python-multipart # Multipart form data handling
      - aiofiles

      # Desktop UI
      - PyQt6>=6.6.0 # Cross-platform native GUI
      - PyQt6-tools # PyQt6 development tools

      # Utils (Image Processing Pipeline)
      - pillow>=10.3.0 # Image processing library
      - opencv-python-headless>=4.10.0.84 # OpenCV for image processing
      - numpy>=1.26.4 # Numerical operations
      - scipy>=1.13.0 # Scientific computing library

      # Development & Testing
      - pytest>=8.2.0 # Unit testing framework
      - black>=23.9.0 # Code formatting
      - pre-commit>s=3.5.0 # Git hooks for quality control

      # ---- Minimal additional essential (new) ----
      - python-dotenv==1.1.1 # Load env variables from .env (added)
# Notes:
# - PyTorch trio (torch/torchvision/torchaudio) is intentionally excluded here.
# - Install them via `pip install -r requirements.txt` after activating this env.
